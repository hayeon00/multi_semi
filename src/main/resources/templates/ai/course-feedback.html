<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8">
  <title>AI ì½”ìŠ¤ í”¼ë“œë°±</title>
  <style>
    body { font-family: Pretendard, sans-serif; margin: 0; padding: 40px; text-align: center; }
    textarea { width: 60%; height: 200px; padding: 15px; font-size: 16px; border-radius: 10px; border: 1px solid #ccc; resize: none; }
    button { margin-top: 30px; padding: 10px 30px; border: none; border-radius: 10px; cursor: pointer; }
    .btn-primary { background-color: #000000; color: #fff; }
    .btn-secondary { background-color: #ccc; color: #333; margin-left: 10px; }
  </style>
</head>
<body>
<h2>AI ì¶”ì²œ ì½”ìŠ¤ì— ëŒ€í•œ í”¼ë“œë°±ì„ ì…ë ¥í•´ì£¼ì„¸ìš” ğŸ“</h2>
<p>ì˜ˆ: "ìˆ™ì†Œê°€ ë„ˆë¬´ ë©€ì–´ìš”", "2ì¼ì°¨ ê´€ê´‘ì§€ ìˆœì„œë¥¼ ë°”ê¿”ì£¼ì„¸ìš”"</p>

<form id="feedbackForm">
  <textarea id="feedbackText" placeholder="í”¼ë“œë°±ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea><br>
  <button type="button" class="btn-primary" onclick="submitFeedback()">í”¼ë“œë°± ì „ì†¡</button>
  <button type="button" class="btn-secondary" onclick="goBack()">ì·¨ì†Œ</button>
</form>

<script th:inline="javascript">
  const planId = [[${planId}]];

  function submitFeedback() {
    const feedback = document.getElementById("feedbackText").value.trim();
    if (!feedback) {
      alert("í”¼ë“œë°±ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    fetch("/ai/courses/feedback", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ planId: planId, feedback: feedback })
    })
            .then(res => res.json())
            .then(data => {
              if (data.status === 200) {
                alert("í”¼ë“œë°±ì´ ë°˜ì˜ëœ ì½”ìŠ¤ê°€ ì¬ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!");
                window.location.href = `/ai/courses/view/${planId}`;
              } else {
                alert("ì½”ìŠ¤ ì¬ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
              }
            });
  }

  function goBack() {
    window.location.href = `/ai/courses/view/${planId}`;
  }
</script>
</body>
</html>
