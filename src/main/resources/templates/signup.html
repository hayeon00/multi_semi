<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>íšŒì›ê°€ì… | Travel Planing</title>
    <link th:href="@{/css/login.css}" rel="stylesheet">
</head>
<body>
<header>
    <div class="logo">
        <img th:src="@{/images/logo.png}" alt="Logo">
        <span class="title">TRAVEL PLANING</span>
    </div>
    <nav>
        <a th:href="@{/}">Home</a>
    </nav>
</header>

<main>
    <div class="left-section">
        <h2>íšŒì›ê°€ì… í¼</h2>
        <p>ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”</p>
    </div>

    <div class="right-section">
        <div class="form-group">
            <label for="loginId">ì•„ì´ë””</label>
            <input type="text" id="loginId" placeholder="Enter your ID">
        </div>

        <div class="form-group">
            <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="password" placeholder="Create a password">
        </div>

        <div class="form-group">
            <label for="username">ì´ë¦„</label>
            <input type="text" id="username" placeholder="Enter your name">
        </div>

        <div class="form-group">
            <label for="tel">ì „í™”ë²ˆí˜¸</label>
            <input type="text" id="tel" placeholder="Enter your phone number">
        </div>

        <div class="form-group">
            <label for="email">ì´ë©”ì¼</label>
            <input type="email" id="email" placeholder="Enter your email">
        </div>

        <div class="btn-group">
            <button type="button" class="btn cancel" onclick="location.href='/login'">ì·¨ì†Œ</button>
            <button type="button" class="btn signup" onclick="signup()">ê³„ì • ìƒì„±</button>
        </div>

        <div class="msg" id="msg"></div>
    </div>
</main>

<footer>
    &copy; 2025 Travel Planing. All rights reserved.
</footer>

<script>
    async function signup() {
        const loginId = document.getElementById("loginId").value.trim();
        const password = document.getElementById("password").value.trim();
        const username = document.getElementById("username").value.trim();
        const tel = document.getElementById("tel").value.trim();
        const email = document.getElementById("email").value.trim();
        const msgBox = document.getElementById("msg");

        if (!loginId || !password || !username || !tel || !email) {
            msgBox.textContent = "ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.";
            msgBox.style.color = "red";
            return;
        }

        try {
            const response = await fetch("/auth/signup", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    loginId: loginId,
                    password: password,
                    username: username,
                    tel: tel,
                    email: email
                })
            });

            console.log("ì‘ë‹µ ìƒíƒœì½”ë“œ:", response.status);
            const text = await response.text();
            console.log("ì‘ë‹µ ë°”ë””:", text);

            if (response.ok) {
                msgBox.textContent = "íšŒì›ê°€ì… ì„±ê³µ! ğŸ‰ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.";
                msgBox.style.color = "green";
                setTimeout(() => window.location.href = "/login", 1500);
            } else {
                msgBox.textContent = "íšŒì›ê°€ì… ì‹¤íŒ¨ âŒ ì…ë ¥ê°’ì„ ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”.";
                msgBox.style.color = "red";
            }
        } catch (e) {
            console.error(e);
            msgBox.textContent = "ì„œë²„ ì˜¤ë¥˜ ë°œìƒ âŒ";
            msgBox.style.color = "red";
        }
    }
</script>
</body>
</html>
