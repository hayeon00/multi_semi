<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>코스 리뷰 작성</title>
    <link th:href="@{/css/review.css}" rel="stylesheet">
</head>
<body>
<h2>리뷰 작성</h2>

<form id="reviewForm" enctype="multipart/form-data">
    <input type="hidden" name="targetId" th:value="${courseId}">

    <label>제목</label>
    <input type="text" name="title" required><br>

    <label>내용</label>
    <textarea name="content" required></textarea><br>

    <label>사진 업로드</label>
    <input type="file" name="reviewImages" multiple><br>

    <button type="submit">리뷰 등록</button>
</form>

<script th:src="@{/js/common.js}"></script>
<script>
    const form = document.getElementById('reviewForm');
    form.addEventListener('submit', async function (e) {
        e.preventDefault();

        const formData = new FormData(form);

        const response = await fetchWithRefresh('/reviews/view/regist/course', {
            method: 'POST',
            body: formData,
            credentials: 'include'
        });

        const result = await response.text();

        if (response.ok) {
            alert('리뷰가 등록되었습니다!');
            window.location.href = '/mypage'; // 또는 리뷰 리스트 페이지
        } else {
            alert('등록 실패: ' + result);
        }
    });
</script>
</body>
</html>
